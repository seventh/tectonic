= Tectonic

== Stratégie de génération

Ligne par ligne, colonne par colonne, une case à la fois (palier).

=== Exploitation des résultats intermédiaires

Un résultat notable est qu'avec la sauvegarde des paliers intermédiaires,
le palier L×(H-1)×M du problème (L, H, M) est le mếme que pour tous les
problèmes (L, H+n, M) quelque soit n >= 0.

=== Limitation du contexte

La génération d'une nouvelle ligne n'est sensible qu'aux (H-1) lignes
précédentes. On peut même envisager une limitation plus drastique encore
en considérant la frontière constituée de polyominos pleins.

La définition de la frontière minimale est la suivante : c'est l'ensemble
des cases qui appartiennent à la même zone que les cases limitrophes d'au moins
une case qui n'a pas (encore) de *valeur* assignée.

Par exemple, dans :

+-+-+-+-+
|. . . .|
+ + + + +
|4|5|4 .|
+ +-+-+ +
|2|3 2|3|
+-+ +-+ +
|5 4|5 4|
+ +-+-+-+
|1|2 3 1|
+-+-+-+-+

la frontière est :

+-+-+-+-+
|. . . .|
+ + + + +
|4|5|4 .|
+ +-+-+ +
|2|3 2|3|
+-+ +-+ +
|5 4|5 4|
+ +-+-+-+
|1|… … …|
+-+-+-+-+

Ici, même la zone 1/5/4/3/2 en forme de M fait partie de la frontière, car le 2
à l'extrêmité est limitrophe d'une case indéterminée.

== Spécificité du format d'encodage

Le format d'encodage doit permettre de représenter :

* des grilles dont le découpage en zones est connu, mais pas toutes les valeurs.
C'est a priori le besoin premier, pour stocker des puzzles à résoudre ;
* des grilles dont le découpage en zones n'est pas totalement connu, ce qui est
utile pour le générateur de grilles, avec sauvegarde des étapes intermédiaires.

De plus, s'il permet de conserver des codes compacts alors que les cases non
encore générées sont inconnues, c'est bien aussi (évitons d'encoder des 0 pour
rien)

== Spécificité du format d'enregistrement

Pour être certain que l'enregistrement d'un palier est complet, il faut un
marqueur en fin de fichier dont la présence assure sans équivoque l'intégrité
de celui-ci. Cela peut-être :

* un code numérique qui ne représente pas un code valide au sens du format
d'encodage (e.g. -1)
* une chaîne de caractères spécifique (e.g. «FIN»).

Idéalement, il faut un marqueur :

* robuste au tri numérique du fichier, c'est-à-dire qui conserve sa place après
un tri.
* facilitant le traitement normal des codes (typiquement, un code numérique)

À savoir, lors d'un tri numérique, toute chaîne de caractères est interprétée
comme un nombre, et est donc estimé à «0» la plupart du temps.

== Transposition

Il est forcément intéressant de réutiliser les paliers (i.e. résultats
intermédiaires) précédemment atteints pour générer d'autres grilles. Au vu de
la stratégie de génération, qui génère ligne à ligne, il semble pertinent de
toujours favoriser la génération de grilles telles que H >= L, quitte à
intervertir les dimensions caractéristiques. Alors, une fois que l'on obtient
les grilles L×H, il ne reste plus qu'à les transposer une à une pour obtenir
les grilles H×L.

== Parallélisation des traitements

Afin d'accélérer les traitements, on cherche à les mener de front, en
parallèle. Il y a cependant quelques précautions à prendre.

La stratégie actuelle de génération de palier produit des doublons, du fait de
la fusion a posteriori de Régions encore distinctes au palier précédent. Cette
fusion est indispensable pour atteindre certaines Grilles qui ne peuvent pas
être obtenues d'une autre manière. C'est pourquoi la génération utilise un
`set` pour stocker les résultats, afin d'assurer ce dédoublonnage.

=== Dédoublonnage

Ce dédoublonnage est extrêmement coûteux en mémoire, à tel point que c'est
devenu le facteur limitant de la génération actuellement. Deux solutions pour
s'en passer :

1) Ne plus générer de doublon tout court. Cela consisterait à vérifier avant
d'envisager la fusion que la grille issue de la fusion mais sans ajout d'une
nouvelle valeur n'est pas déjà présente dans le palier précédent.
2) Différer le dédoublonnage. Produire toutes les grilles possibles avec
doublons, puis effectuer une passe de tri/dédoublonnage.

La recherche d'une grille déjà existante peut se faire par dichotomie dans le
palier précédent. À étudier.

Une autre façon de déterminer si on va générer un doublon, c'est de considérer
si les deux Régions à fusionner sont limitrophes. Si c'est bien le cas, une
autre version de la grille existe déjà avec ces régions ne formant qu'un.

=== Parallélisation
